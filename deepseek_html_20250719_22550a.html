<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圈平衡计算器 3.0</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
            color: white;
            text-align: center;
            padding: 25px 20px;
            border-bottom: 5px solid #3a5ca0;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        header p {
            opacity: 0.9;
            max-width: 700px;
            margin: 0 auto;
        }
        
        .calculator-container {
            display: flex;
            flex-wrap: wrap;
            padding: 25px;
        }
        
        .input-section {
            flex: 1;
            min-width: 300px;
            padding: 25px;
            background-color: #f9fbfd;
            border-radius: 10px;
            margin-right: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .results-section {
            flex: 2;
            min-width: 500px;
            padding: 25px;
        }
        
        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4b6cb7;
            color: #182848;
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #d1d8e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .input-group input:focus {
            border-color: #4b6cb7;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
            outline: none;
        }
        
        .btn-calculate {
            background: linear-gradient(90deg, #4b6cb7 0%, #3a5ca0 100%);
            color: white;
            border: none;
            padding: 14px 25px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            margin-top: 10px;
            letter-spacing: 0.5px;
        }
        
        .btn-calculate:hover {
            background: linear-gradient(90deg, #3a5ca0 0%, #2a4a80 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(58, 92, 160, 0.4);
        }
        
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .results-table th {
            background-color: #4b6cb7;
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        .results-table td {
            padding: 15px;
            border-bottom: 1px solid #eef2f7;
        }
        
        .results-table tr:nth-child(even) {
            background-color: #f8fafd;
        }
        
        .results-table tr:last-child td {
            border-bottom: none;
        }
        
        .results-table tr:hover {
            background-color: #edf2fa;
        }
        
        .highlight {
            font-weight: bold;
            color: #2c3e50;
            background-color: #e3ecff !important;
        }
        
        .summary {
            background-color: #f0f7ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 4px solid #4b6cb7;
        }
        
        .summary h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .summary-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .summary-item h4 {
            color: #4b6cb7;
            margin-bottom: 8px;
            font-size: 1.1rem;
        }
        
        .explanation {
            background-color: #fff9e6;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 4px solid #ffc107;
        }
        
        .explanation h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .explanation p {
            margin-bottom: 10px;
            line-height: 1.7;
        }
        
        .explanation ul {
            margin: 15px 0 15px 30px;
        }
        
        .explanation li {
            margin-bottom: 8px;
        }
        
        @media (max-width: 900px) {
            .calculator-container {
                flex-direction: column;
            }
            
            .input-section {
                margin-right: 0;
                margin-bottom: 30px;
            }
        }
        
        .pig-type-a { color: #4b6cb7; font-weight: bold; }
        .pig-type-b { color: #3498db; font-weight: bold; }
        .pig-type-c { color: #2ecc71; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>圈平衡计算器 3.0</h1>
            <p>基于Excel逻辑设计的智能装猪方案计算工具，优化猪栏分配与平衡</p>
        </header>
        
        <div class="calculator-container">
            <div class="input-section">
                <h2 class="section-title">输入参数</h2>
                
                <div class="input-group">
                    <label for="totalPigs">总头数</label>
                    <input type="number" id="totalPigs" value="700" min="1">
                </div>
                
                <div class="input-group">
                    <label for="totalPens">总圈数</label>
                    <input type="number" id="totalPens" value="28" min="1">
                </div>
                
                <h3 style="margin: 25px 0 15px; color: #2c3e50;">猪栏配置</h3>
                
                <div class="input-group">
                    <label for="pensA"><span class="pig-type-a">A猪</span> 栏位数量</label>
                    <input type="number" id="pensA" value="12" min="0">
                </div>
                
                <div class="input-group">
                    <label for="pensB"><span class="pig-type-b">B猪</span> 栏位数量</label>
                    <input type="number" id="pensB" value="10" min="0">
                </div>
                
                <div class="input-group">
                    <label for="pensC"><span class="pig-type-c">C猪</span> 栏位数量</label>
                    <input type="number" id="pensC" value="2" min="0">
                </div>
                
                <h3 style="margin: 25px 0 15px; color: #2c3e50;">增量参数</h3>
                
                <div class="input-group">
                    <label for="incrementB"><span class="pig-type-b">B猪</span> 单栏增量参数</label>
                    <input type="number" id="incrementB" value="1" min="0">
                </div>
                
                <div class="input-group">
                    <label for="incrementC"><span class="pig-type-c">C猪</span> 单栏增量参数</label>
                    <input type="number" id="incrementC" value="1" min="0">
                </div>
                
                <button class="btn-calculate" onclick="calculate()">计算平衡方案</button>
            </div>
            
            <div class="results-section">
                <h2 class="section-title">计算结果</h2>
                
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>类型</th>
                            <th>建议装猪数</th>
                            <th>栏位数量</th>
                            <th>总装猪数</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="pig-type-a">A猪</span></td>
                            <td id="suggestedA">28.58</td>
                            <td id="pensAResult">12</td>
                            <td id="totalA">343</td>
                        </tr>
                        <tr>
                            <td><span class="pig-type-b">B猪</span></td>
                            <td id="suggestedB">29.58</td>
                            <td id="pensBResult">10</td>
                            <td id="totalB">296</td>
                        </tr>
                        <tr>
                            <td><span class="pig-type-c">C猪</span></td>
                            <td id="suggestedC">30.58</td>
                            <td id="pensCResult">2</td>
                            <td id="totalC">61</td>
                        </tr>
                        <tr class="highlight">
                            <td>合计</td>
                            <td>-</td>
                            <td id="totalPensResult">24</td>
                            <td id="totalPigsResult">700</td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="summary">
                    <h3>方案摘要</h3>
                    <div class="summary-content">
                        <div class="summary-item">
                            <h4>装猪圈</h4>
                            <p id="usedPens">24 圈</p>
                        </div>
                        <div class="summary-item">
                            <h4>预留圈</h4>
                            <p id="reservedPens">4 圈</p>
                        </div>
                        <div class="summary-item">
                            <h4>装猪率</h4>
                            <p id="penUsage">85.7%</p>
                        </div>
                        <div class="summary-item">
                            <h4>平衡偏差</h4>
                            <p id="balanceDeviation">0 头</p>
                        </div>
                    </div>
                </div>
                
                <div class="explanation">
                    <h3>计算说明</h3>
                    <p>本计算器基于Excel中的圈平衡逻辑，计算公式如下：</p>
                    <ul>
                        <li><strong>A猪每栏装猪数</strong> = (总头数 - B猪栏数×B猪增量 - C猪栏数×(B猪增量+C猪增量)) ÷ (A猪栏数+B猪栏数+C猪栏数)</li>
                        <li><strong>B猪每栏装猪数</strong> = A猪每栏装猪数 + B猪增量</li>
                        <li><strong>C猪每栏装猪数</strong> = B猪每栏装猪数 + C猪增量</li>
                        <li><strong>总装猪数</strong> = Σ(各猪种每栏装猪数 × 栏数)</li>
                        <li><strong>预留圈</strong> = 总圈数 - (A猪栏数+B猪栏数+C猪栏数)</li>
                    </ul>
                    <p>注：实际应用中可根据计算结果微调，使总装猪数更接近总头数。</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        function calculate() {
            // 获取输入值
            const totalPigs = parseFloat(document.getElementById('totalPigs').value) || 0;
            const totalPens = parseFloat(document.getElementById('totalPens').value) || 0;
            const pensA = parseFloat(document.getElementById('pensA').value) || 0;
            const pensB = parseFloat(document.getElementById('pensB').value) || 0;
            const pensC = parseFloat(document.getElementById('pensC').value) || 0;
            const incrementB = parseFloat(document.getElementById('incrementB').value) || 0;
            const incrementC = parseFloat(document.getElementById('incrementC').value) || 0;
            
            // 计算每栏建议装猪数
            const totalPensUsed = pensA + pensB + pensC;
            const numerator = totalPigs - (pensB * incrementB) - (pensC * (incrementB + incrementC));
            const denominator = pensA + pensB + pensC;
            
            const suggestedA = denominator > 0 ? numerator / denominator : 0;
            const suggestedB = suggestedA + incrementB;
            const suggestedC = suggestedB + incrementC;
            
            // 计算总装猪数
            const totalA = pensA * suggestedA;
            const totalB = pensB * suggestedB;
            const totalC = pensC * suggestedC;
            const totalLoaded = totalA + totalB + totalC;
            
            // 计算预留圈
            const reservedPens = totalPens - totalPensUsed;
            
            // 计算装猪率和平衡偏差
            const penUsage = totalPens > 0 ? (totalPensUsed / totalPens * 100).toFixed(1) : 0;
            const balanceDeviation = totalPigs - totalLoaded;
            
            // 更新页面显示
            document.getElementById('suggestedA').textContent = suggestedA.toFixed(2);
            document.getElementById('suggestedB').textContent = suggestedB.toFixed(2);
            document.getElementById('suggestedC').textContent = suggestedC.toFixed(2);
            
            document.getElementById('pensAResult').textContent = pensA;
            document.getElementById('pensBResult').textContent = pensB;
            document.getElementById('pensCResult').textContent = pensC;
            
            document.getElementById('totalA').textContent = Math.round(totalA);
            document.getElementById('totalB').textContent = Math.round(totalB);
            document.getElementById('totalC').textContent = Math.round(totalC);
            
            document.getElementById('totalPensResult').textContent = totalPensUsed;
            document.getElementById('totalPigsResult').textContent = Math.round(totalLoaded);
            
            document.getElementById('usedPens').textContent = totalPensUsed + " 圈";
            document.getElementById('reservedPens').textContent = reservedPens + " 圈";
            document.getElementById('penUsage').textContent = penUsage + "%";
            document.getElementById('balanceDeviation').textContent = balanceDeviation.toFixed(0) + " 头";
        }
        
        // 初始化计算
        window.onload = calculate;
    </script>
</body>
</html>